var y,p,R=class extends HTMLElement{constructor(){super(),this.canvasWidth=800,this.canvasHeight=600,this.lineWidth=5,this.attachShadow({mode:"open"})}static get observedAttributes(){return["width","height","controls"]}attributeChangedCallback(e,s,o){e==="width"?(this.canvasWidth=parseInt(o),this.canvas&&(this.canvas.width=this.canvasWidth,this.ctx.lineWidth=this.lineWidth)):e==="height"?(this.canvasHeight=parseInt(o),this.canvas&&(this.canvas.height=this.canvasHeight,this.ctx.lineWidth=this.lineWidth)):e==="controls"&&(o&&o!=="false"?this.shadowRoot.getElementById("controls-container").style.display="":this.shadowRoot.getElementById("controls-container").style.display="none")}setup=async()=>{this.fetch&&await this.fetch,this.canvas=this.shadowRoot.getElementById("canvas"),this.ctx=this.canvas.getContext("2d");let e=this.canvas,s=this.ctx,o=5;e.width=this.canvasWidth,e.height=this.canvasHeight;let h="crosshair";e.style.cursor=h;let E="#000000";s.strokeStyle="#000000",this.ctx.lineWidth=this.lineWidth,this.shadowRoot.getElementById("color-picker").addEventListener("input",t=>{E=t.target.value,this.ctx.strokeStyle=t.target.value}),this.shadowRoot.getElementById("clear-button").addEventListener("click",()=>{s.clearRect(0,0,e.width,e.height)});let Y=this.shadowRoot.getElementById("zoom-range");Y.addEventListener("input",t=>{let n=parseFloat(t.target.value);e.style.transform=`scale(${n})`});let u=!1,c=0,r=0,g=!1,d=1,l=0,a=0,v=0,W=0,w=!1,X=t=>{let n=e.getBoundingClientRect(),i,x,H,B,b;if(t){let $=t.deltaY>0?-.1:.1;i=Math.min(Math.max(.1,d+$),o)}!t||w||i<1?(i=1,l=0,a=0,x=0,B=0,H=0,b=0,w=!1):(x=(t.clientX-n.left)/d-l,B=(t.clientY-n.top)/d-a,H=(t.clientX-n.left)/i-l,b=(t.clientY-n.top)/i-a),l+=x-H,a+=B-b,e.style.transform=`translate(${l}px, ${a}px) scale(${i})`,d=i,Y.value=i};this.shadowRoot.getElementById("recenter-button").addEventListener("click",()=>{w=!0,X()}),e.parentElement.addEventListener("wheel",t=>{t.preventDefault(),X(t)}),e.addEventListener("mousedown",t=>{t.button===1||t.altKey?e.style.cursor="move":[c,r]=[t.offsetX*(this.canvasWidth/e.clientWidth),t.offsetY*(this.canvasHeight/e.clientHeight)]});let m=t=>{let n=t.offsetX*(this.canvasWidth/e.clientWidth),i=t.offsetY*(this.canvasHeight/e.clientHeight);s.fillRect(n-this.lineWidth/2,i-this.lineWidth/2,this.lineWidth,this.lineWidth)};e.parentElement.addEventListener("mousedown",t=>{t.button===1||t.altKey?(g=!0,v=t.clientX-l,W=t.clientY-a,e.parentElement.style.cursor="move"):(u=!0,f||(s.fillStyle=E,m(t),m(t),m(t)))});let M=t=>{if(f){s.lineCap="round",s.beginPath(),s.moveTo(typeof c=="number"?c:t.offsetX*(this.canvasWidth/e.clientWidth),typeof r=="number"?r:t.offsetY*(this.canvasHeight/e.clientHeight));let n=t.offsetX*(this.canvasWidth/e.clientWidth),i=t.offsetY*(this.canvasHeight/e.clientHeight);s.lineTo(n,i),s.stroke(),[c,r]=[n,i]}else s.fillStyle=E,m(t)};e.addEventListener("mousemove",t=>{u&&M(t)}),e.parentElement.addEventListener("mousemove",t=>{g&&(t.clientX-v!==0||t.clientY-W!==0)&&(l=t.clientX-v,a=t.clientY-W,e.style.transform=`translate(${l}px, ${a}px) scale(${d})`)}),e.addEventListener("mouseup",()=>{u=!1,c=void 0,r=void 0,e.style.cursor=h}),e.addEventListener("mouseout",()=>{u=!1}),e.parentElement.addEventListener("mouseup",()=>{g=!1,e.parentElement.style.cursor="default"}),e.parentElement.addEventListener("mouseout",()=>{g=!1});let f=!0,I=this.shadowRoot.getElementById("line-label"),k=this.shadowRoot.getElementById("line-width"),L=this.shadowRoot.getElementById("toggle-mode-button");L.addEventListener("click",()=>{f=!f,f?(L.innerHTML="Line Mode",I.innerHTML="Line Width:",h="crosshair"):(L.innerHTML="Pixel Mode",I.innerHTML="Pixel Size:",h="default"),e.style.cursor=h}),k.addEventListener("input",t=>{this.lineWidth=parseInt(t.target.value),s.lineWidth=this.lineWidth})};connectedCallback(){!y||!p?this.fetch=Promise.all([fetch("CanvasWithControls.html").then(e=>e.text()),fetch("CanvasWithControls.css").then(e=>e.text())]).then(([e,s])=>{p=e,y=s,this.shadowRoot.innerHTML=`
                    <style>
                        ${y}
                    </style>
                    ${p}
                `}).catch(e=>{console.error("Error fetching resources:",e)}):this.shadowRoot.innerHTML=`
                    <style>
                        ${y}
                    </style>
                    ${p}
            `,this.setup()}disconnectedCallback(){}};customElements.define("canvas-with-controls",R);export{R as CanvasWithControls};
